#!/usr/bin/env ruby

require_relative '../lib/common'

# bin/publish

class Publish

  def start
    # if File.exists? '.ruby-version'
    #   cmd = <<-CMD
    #     rvm use `cat .ruby-version`@`cat .ruby-gemset` --create
    #   CMD
    #   system cmd
    # end
    # exit 1

    system "bundle && bundle exec rspec"
    system "gem build locomotivecms_common.gemspec"
    system "git tag -a v#{Locomotive::Common::VERSION} -m 'version #{Locomotive::Common::VERSION}'"
    system "git push --tags"
    system "gem push locomotivecms_common-#{Locomotive::Common::VERSION}.gem"
    system "git push origin master"
  end

end

Publish.new.start